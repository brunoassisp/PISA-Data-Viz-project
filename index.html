<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.13.0/d3.min.js"></script>
    <style>
      .y.axis {
        padding: 10px;
      }

      .axis text {
        font: 10px sans-serif;
      }

      .axis path,
      .axis line {
        fill: none;
        stroke: #000;
        shape-rendering: crispEdges;
      }
    </style>
    <script type="text/javascript">
      function draw(data) {
        "use strict";
        var margin = {top: 100, right: 100, bottom: 100, left: 100},
            width = 1100,
            height = 600,
            innerWidth = width - margin.left - margin.right,
            innerHeight = height - margin.top - margin.bottom;

        // x-axis labels
        var frequency_list = d3.map(data, function(d) {
          return d.frequency;
        }).keys();

        var svg = d3.select('body')
            .append('svg')
            .attr('width', width)
            .attr('height', height);

        // Wrap everything in inner container
        var g = svg.append('g')
            .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')
            .attr('class', 'chart');

        // Create scales
        var frequency_scale = d3.scaleBand()
            .rangeRound([0, innerWidth])
            .domain(frequency_list);

        var percent_scale = d3.scaleLinear()
            .range([innerHeight, 0])
            .domain([0, 100]);

        // Create axis generators
        var xAxis = d3.axisBottom(frequency_scale);
        var yAxis = d3.axisLeft(percent_scale)

        // Append axises
        var percent_axis = g.append('g')
            .call(yAxis);

        var frequency_axis = g.append('g')
          .attr('transform', 'translate(0,' + innerHeight + ')')
          .call(xAxis);

        // Draw circles
        var circles = g.selectAll('circle')
            .data(data)
            .enter()
            .append('circle')
            .attr('cx', function(d) {
                return frequency_scale(d['frequency']) + frequency_scale.bandwidth() / 2;
            })
            .attr('cy', function(d) {
                return percent_scale(d['count_percent']);
            })
            .attr('r', function(d) {
                return 2;
            })
            .attr('fill', function(d) {
                return 'black';
            })


      }
    </script>
  </head>
<body>
  <script type="text/javascript">

    // Change the datatype of some features
    function type(d) {
      d.count_percent = +d.count_percent;
      // TODO Change the other types

      return d;
    }

    d3.csv("PISA_Math_Behavior.csv", type, draw);
  </script>
</body>
</html>
